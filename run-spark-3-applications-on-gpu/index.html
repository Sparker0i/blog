<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Run your Apache Spark applications on a GPU</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preload" href="/assets/css/app.css?v=4055984ae1" as="style" />
    <link rel="preload" href="/assets/js/manifest.js?v=4055984ae1" as="script" />
    <link rel="preload" href="/assets/js/vendor/content-api.min.js?v=4055984ae1" as="script" />
    <link rel="preload" href="/assets/js/vendor.js?v=4055984ae1" as="script" />
    <link rel="preload" href="/assets/js/app.js?v=4055984ae1" as="script" />

      <link rel="preload" href="/assets/css/post.css?v=4055984ae1" as="style" />
  <link rel="preload" href="/assets/js/post.js?v=4055984ae1" as="script" />


    <style>
      /* These font-faces are here to make fonts work if the Ghost instance is installed in a subdirectory */

      /* source-sans-pro-regular */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('SourceSansPro-Regular'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff2?v=4055984ae1") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff?v=4055984ae1") format('woff');
      }

      /* source-sans-pro-600 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 600;
        font-display: swap;
        src: local('SourceSansPro-SemiBold'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff2?v=4055984ae1") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff?v=4055984ae1") format('woff');
      }

      /* source-sans-pro-700 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: local('SourceSansPro-Bold'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff2?v=4055984ae1") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff?v=4055984ae1") format('woff');
      }

      /* iconmoon */
      @font-face {
        font-family: 'icomoon';
        font-weight: normal;
        font-style: normal;
        font-display: swap;
        src: url("/assets/fonts/icomoon/icomoon.eot?101fc3?v=4055984ae1");
        src: url("/assets/fonts/icomoon/icomoon.eot?101fc3#iefix?v=4055984ae1") format('embedded-opentype'),
        url("/assets/fonts/icomoon/icomoon.ttf?101fc3?v=4055984ae1") format('truetype'),
        url("/assets/fonts/icomoon/icomoon.woff?101fc3?v=4055984ae1") format('woff'),
        url("/assets/fonts/icomoon/icomoon.svg?101fc3#icomoon?v=4055984ae1") format('svg');
      }
    </style>

    <link rel="stylesheet" type="text/css" href="/assets/css/app.css?v=4055984ae1" media="screen" />

      <link rel="stylesheet" type="text/css" href="/assets/css/post.css?v=4055984ae1" media="screen" />


    

    <meta name="description" content="Wanted to run your Spark job on a GPU but didn&#x27;t know how? Well, your search ends here. Read my blog post to find out how you can take advantage of GPU." />
    <link rel="icon" href="/favicon.png" type="image/png" />
    <link rel="canonical" href="http://localhost:2368/run-spark-3-applications-on-gpu/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="http://localhost:2368/run-spark-3-applications-on-gpu/amp/" />
    
    <meta property="og:site_name" content="Sparker0i&#x27;s Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Run your Apache Spark applications on a GPU" />
    <meta property="og:description" content="Wanted to run your Spark job on a GPU but didn&#x27;t know how? Well, your search ends here :)" />
    <meta property="og:url" content="http://localhost:2368/run-spark-3-applications-on-gpu/" />
    <meta property="og:image" content="http://localhost:2368/content/images/2020/09/untitled-3-.png" />
    <meta property="article:published_time" content="2020-09-19T03:44:00.000Z" />
    <meta property="article:modified_time" content="2020-09-19T11:44:57.000Z" />
    <meta property="article:tag" content="Spark" />
    <meta property="article:tag" content="Scala" />
    <meta property="article:tag" content="Graphics" />
    <meta property="article:tag" content="Nvidia" />
    <meta property="article:tag" content="GPU" />
    
    <meta property="article:publisher" content="https://www.facebook.com/Sparker0i" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Run your Apache Spark applications on a GPU" />
    <meta name="twitter:description" content="Wanted to run your Spark job on a GPU but didn&#x27;t know how? Well, your search ends here :)" />
    <meta name="twitter:url" content="http://localhost:2368/run-spark-3-applications-on-gpu/" />
    <meta name="twitter:image" content="http://localhost:2368/content/images/2020/09/untitled-3-.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Aaditya Menon" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Spark, Scala, Graphics, Nvidia, GPU" />
    <meta name="twitter:site" content="@Sparker0i" />
    <meta name="twitter:creator" content="@Sparker0i" />
    <meta property="og:image:width" content="810" />
    <meta property="og:image:height" content="400" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Sparker0i&#x27;s Blog",
        "url": "http://localhost:2368/",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/content/images/2020/02/6006221719b070975f272141125c0689.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Aaditya Menon",
        "image": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/content/images/2022/02/72678158_2843214719045409_4986419922138562560_n.jpg",
            "width": 2000,
            "height": 2000
        },
        "url": "http://localhost:2368/author/sparker0i/",
        "sameAs": [
            "https://twitter.com/Sparker0i"
        ]
    },
    "headline": "Run your Apache Spark applications on a GPU",
    "url": "http://localhost:2368/run-spark-3-applications-on-gpu/",
    "datePublished": "2020-09-19T03:44:00.000Z",
    "dateModified": "2020-09-19T11:44:57.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:2368/content/images/2020/09/untitled-3-.png",
        "width": 810,
        "height": 400
    },
    "keywords": "Spark, Scala, Graphics, Nvidia, GPU",
    "description": "Wanted to run your Spark job on a GPU but didn&#x27;t know how? Well, your search ends here :)",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.33" />
    <link rel="alternate" type="application/rss+xml" title="Sparker0i&#x27;s Blog" href="http://localhost:2368/rss/" />
    
    <script defer src="/public/cards.min.js?v=4055984ae1"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=4055984ae1">
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7XJJR5L4E3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7XJJR5L4E3');
</script>
<meta property="fb:pages" content="110085507196751" />
<meta name="google-site-verification" content="dW-FKUoBj2jzKbsORQiymBPtiZ3ROGD5gseblJwYl80" />
<script data-ad-client="ca-pub-7053772126133454" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><style>:root {--ghost-accent-color: #00e1ff;}</style>

    <style>
      :root {
        --primary-subtle-color: var(--ghost-accent-color) !important;
      }
    </style>

    <script>
      // @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt Expat
      const ghostHost = "http://localhost:2368"
      // @license-end
    </script>

  </head>
  <body class="post-template tag-spark tag-scala tag-graphics tag-nvidia tag-gpu">
    



  
<header class="m-header with-picture js-header">
  <div class="m-mobile-topbar" data-aos="fade-down">
    <button class="m-icon-button in-mobile-topbar js-open-menu" aria-label="Open menu">
      <span class="icon-menu" aria-hidden="true"></span>
    </button>
      <a href="http://localhost:2368" class="m-logo in-mobile-topbar">
        <img src="http://localhost:2368/content/images/2020/02/6006221719b070975f272141125c0689.png" alt="Sparker0i&#x27;s Blog" class="">
      </a>
    <button class="m-icon-button in-mobile-topbar js-open-search" aria-label="Open search">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
  </div>

  <div class="m-menu js-menu">
    <button class="m-icon-button outlined as-close-menu js-close-menu" aria-label="Close menu">
      <span class="icon-close"></span>
    </button>
    <div class="m-menu__main" data-aos="fade-down">
      <div class="l-wrapper">
        <div class="m-nav js-main-nav">
          <nav class="m-nav__left js-main-nav-left" role="navigation" aria-label="Main menu">
            <ul>
                <li class="only-desktop">
                  <a href="http://localhost:2368" class="m-logo">
                    <img src="http://localhost:2368/content/images/2020/02/6006221719b070975f272141125c0689.png" alt="Sparker0i&#x27;s Blog" class="">
                  </a>
                </li>
                
    <li class="nav-scala">
      <a href="http://localhost:2368/tag/scala/">Scala</a>
    </li>
    <li class="nav-spark">
      <a href="http://localhost:2368/tag/spark/">Spark</a>
    </li>

              <li class="submenu-option js-submenu-option">
                <button class="m-icon-button in-menu-main more js-toggle-submenu" aria-label="Open submenu">
                  <span class="icon-more" aria-hidden="true"></span>
                </button>
                <div class="m-submenu js-submenu">
                  <div class="l-wrapper in-submenu">
                    <section class="m-recent-articles">
                      <h3 class="m-submenu-title in-recent-articles">Recent articles</h3>
                          <div class="swiper js-recent-slider">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                  <a href="/podman-best-docker-alternative/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="/content/images/size/w300/2022/03/podman-vs-docker.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Podman with Desktop Companion: The best alternative to Docker Desktop">
                                      Podman with Desktop Companion: The best alternative to Docker Desktop
                                    </h3>
                                    <span class="m-recent-article__date">a few seconds ago</span>
                                  </a>
                                </div>
                                <div class="swiper-slide">
                                  <a href="/factors-to-look-dealing-crypto/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="https://images.unsplash.com/photo-1621504450181-5d356f61d307?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDN8fGNyeXB0b3xlbnwwfHx8fDE2MjgxMDYyOTU&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Factors to look at while dealing with Cryptocurrencies">
                                      Factors to look at while dealing with Cryptocurrencies
                                    </h3>
                                    <span class="m-recent-article__date">8 months ago</span>
                                  </a>
                                </div>
                                <div class="swiper-slide">
                                  <a href="/health-targeted-digital-advertising-today/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="/content/images/size/w300/2021/01/targeted-nontargeted-houston-marketing-display-advertising1.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Is the state of targeted digital advertising broken?">
                                      Is the state of targeted digital advertising broken?
                                    </h3>
                                    <span class="m-recent-article__date">a year ago</span>
                                  </a>
                                </div>
                                <div class="swiper-slide">
                                  <a href="/run-spark-3-applications-on-gpu/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="/content/images/size/w300/2020/09/untitled-3-.png" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="How to run Spark 3.0 applications on your GPU">
                                      How to run Spark 3.0 applications on your GPU
                                    </h3>
                                    <span class="m-recent-article__date">2 years ago</span>
                                  </a>
                                </div>
                            </div>
                          </div>
                    </section>
                    <section class="m-tags">
                      <h3 class="m-submenu-title">Tags</h3>
                        <ul>
                            <li>
                              <a href="/tag/2fa/">2FA</a>
                            </li>
                            <li>
                              <a href="/tag/adb/">ADB</a>
                            </li>
                            <li>
                              <a href="/tag/asus/">ASUS</a>
                            </li>
                            <li>
                              <a href="/tag/ads/">Ads</a>
                            </li>
                            <li>
                              <a href="/tag/advertising/">Advertising</a>
                            </li>
                            <li>
                              <a href="/tag/analysis/">Analysis</a>
                            </li>
                            <li>
                              <a href="/tag/android/">Android</a>
                            </li>
                            <li>
                              <a href="/tag/android-one/">Android One</a>
                            </li>
                            <li>
                              <a href="/tag/android-project/">Android Project</a>
                            </li>
                            <li>
                              <a href="/tag/assignment/">Assignment</a>
                            </li>
                        </ul>
                    </section>
                  </div>
                </div>
              </li>
            </ul>
          </nav>
          <div class="m-nav__right">
            <button class="m-icon-button in-menu-main js-open-search" aria-label="Open search">
              <span class="icon-search" aria-hidden="true"></span>
            </button>
            <div class="m-toggle-darkmode js-tooltip" data-tippy-content="Toggle light/dark mode" tabindex="0">
              <label for="toggle-darkmode" class="sr-only">
                Toggle light/dark mode
              </label>
              <input id="toggle-darkmode" type="checkbox" class="js-toggle-darkmode">
              <div>
                <span class="icon-moon moon" aria-hidden="true"></span>
                <span class="icon-sunny sun" aria-hidden="true"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</header>

<main class="main-wrap">
    
  <section class="m-hero with-picture" data-aos="fade">
    <div class="m-hero__picture in-post">
      <img
        srcset="
          /content/images/size/w300/2020/09/untitled-3-.png 300w,
          /content/images/size/w600/2020/09/untitled-3-.png 600w,
          /content/images/size/w1000/2020/09/untitled-3-.png 1000w,
          /content/images/size/w2000/2020/09/untitled-3-.png 2000w
        "
        sizes="(max-width: 600px) 600px, (max-width: 1000px) 1000px, 2000px"
        src="/content/images/size/w1000/2020/09/untitled-3-.png"
        alt=""
      />
    </div>
    </section>
  
  <article>
    <div class="l-content in-post">
        <div class="l-wrapper in-post  js-aos-wrapper" data-aos="fade-up"
          data-aos-delay="300">
          <div
            class="l-post-content js-progress-content">
            <header class="m-heading">
              <h1 class="m-heading__title in-post">How to run Spark 3.0 applications on your GPU</h1>
              <div class="m-heading__meta">
                  <a href="http://localhost:2368/tag/spark/" class="m-heading__meta__tag">Spark</a>
                  <span class="m-heading__meta__divider" aria-hidden="true">&bull;</span>
                <span class="m-heading__meta__time">Sep 19, 2020</span>
              </div>
            </header>
            <div class="pos-relative js-post-content">
              <div class="m-share">
                <div class="m-share__content js-sticky">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/run-spark-3-applications-on-gpu/"
                    class="m-icon-button filled in-share" target="_blank" rel="noopener" aria-label="Facebook">
                    <span class="icon-facebook" aria-hidden="true"></span>
                  </a>
                  <a href="https://twitter.com/intent/tweet?text=How%20to%20run%20Spark%203.0%20applications%20on%20your%20GPU&url=http://localhost:2368/run-spark-3-applications-on-gpu/"
                    class="m-icon-button filled in-share" target="_blank" rel="noopener" aria-label="Twitter">
                    <span class="icon-twitter" aria-hidden="true"></span>
                  </a>
                  <button class="m-icon-button filled in-share progress js-scrolltop" aria-label="Scroll to top">
                    <span class="icon-arrow-top" aria-hidden="true"></span>
                    <svg aria-hidden="true">
                      <circle class="progress-ring__circle js-progress" fill="transparent" r="0" />
                    </svg>
                  </button>
                </div>
              </div>
              <p>In one of my previous blog posts, I'd mentioned that Spark 3.0 is coming with Native GPU support. A few days after that, Spark 3.0 released on 18th June 2020. While it did release, there were no mentions of how to run your Spark 3.0 code on a GPU anywhere on the internet. <strong>It changes now.</strong></p><p>In this post, you'll see the prerequisites for running Spark on GPU on a local machine, as well as all installation instructions.</p><h3 id="prerequisites">Prerequisites</h3><p>To run Spark applications on your GPU, it is recommended that you have an <strong>Nvidia GPU </strong>of<strong> Pascal Architecture</strong> or better. This means that you will need an <strong>Nvidia Geforce GTX 1050 or better</strong>. Other requirements are the same as Apache Spark requirements.</p><p><em>(PS. I don't have an AMD GPU, so can't really test and confirm whether this will work with it or not, but chances are very slim as you need a tool called <code>nvidia-smi</code>, which works only with Nvidia GPUs)</em></p><p>You will also need to install <a href="https://spark.apache.org/downloads.html">Apache Spark 3.0</a>, <a href="https://developer.nvidia.com/cuda-downloads">Nvidia CUDA</a> on your machine.</p><p>Other than these, you will also need 2 JARs: <a href="https://mvnrepository.com/artifact/com.nvidia/rapids-4-spark_2.12">Rapids Accelerator</a> and <a href="https://repo1.maven.org/maven2/ai/rapids/cudf/0.15/">NVIDIA CUDF</a> (for CUDA 11).</p><p>You will also need a Linux system to run your jobs. This won't work on Windows as CUDF isn't supported on that platform. However, the CUDF team says they will support CUDA Running on WSL 2.0. To get CUDA Running with WSL, you'll need to be a part of the Windows Insider Program.</p><p>You will also need a GPU Discovery script which tells the program the addresses of GPUs available on your system. Fortunately, the Spark repo has a <a href="https://github.com/apache/spark/blob/master/examples/src/main/scripts/getGpusResources.sh">GPU discovery script</a> handy which can be readily used.</p><h3 id="running">Running</h3><p>For Spark 3.0 to recognize that you will be running your jobs on a GPU, you need to pass a few parameters as Spark confs:</p><ul><li><code>spark.rapids.sql.enabled</code> as <code>true</code></li><li><code>spark.plugins</code> as <code>com.nvidia.spark.SQLPlugin</code></li><li><code>spark.driver.resource.gpu.discoveryScript</code> as &lt;The location where you have downloaded the GPU discovery script from above&gt;</li></ul><p>You can either run this with <code>spark-shell</code> or you can create your own JAR and run it using <code>spark-submit</code> and then pass these configurations.</p><h3 id="performance">Performance</h3><p>In order to illustrate the performance difference between running your Spark program on a CPU vs GPU, I will be using a very simple program which is very much self explanatory:</p><figure class="kg-card kg-code-card"><pre><code>val values: List[Int] = List(100, 500, 1000, 5000, 10000, 50000, 100000, 500000, 1000000, 5000000, 10000000, 50000000, 100000000, 500000000, 1000000000)

for (upperBound &lt;- values) {
    val df = sc.makeRDD(1 to upperBound).toDF("a")
    val df2 = sc.makeRDD(1 to upperBound).toDF("b")
    println(df.join(df2, $"a" === $"b" / 2).count())
}</code></pre><figcaption>Spark program for testing performance: CPU vs GPU</figcaption></figure><p>Further, in order to level the playing field between the 2 runs, I'm setting certain common configs:</p><ul><li><code>spark.locality.wait</code> = <code>0s</code></li><li><code>spark.driver.memory</code> = <code>10G</code></li><li><code>spark.sql.files.maxPartitionBytes</code> = <code>512 * 1024 * 1024</code></li><li><code>spark.sql.shuffle.partitions</code> = <code>10</code></li></ul><p>Here are the specs of the laptop which I used to perform this test:</p><ul><li>6-core Intel Core i7-8750H</li><li>16GB DDR4 RAM, 256GB NVME SSD</li><li>8GB Nvidia Geforce RTX 2080 Graphics Card</li></ul><p>Here are two plots showing the <code>upperBound</code> against time taken:</p><!--kg-card-begin: html--><!DOCTYPE html>
<html>
	<head>
		<title>chart created with amCharts | amCharts</title>
		<meta name="description" content="chart created using amCharts live editor" />
		
		<!-- amCharts javascript sources -->
		<script type="text/javascript" src="https://www.amcharts.com/lib/3/amcharts.js"></script>
		<script type="text/javascript" src="https://www.amcharts.com/lib/3/serial.js"></script>
		

		<!-- amCharts javascript code -->
		<script type="text/javascript">
			AmCharts.makeChart("chartdiv",
				{
					"type": "serial",
					"categoryField": "category",
					"startDuration": 1,
					"categoryAxis": {
						"gridPosition": "start",
						"title": "Record Count"
					},
					"trendLines": [],
					"graphs": [
						{
							"balloonText": "Time taken to process [[category]] records in [[title]]:[[value]]",
							"bullet": "round",
							"id": "AmGraph-1",
							"title": "CPU",
							"valueField": "CPU"
						},
						{
							"balloonText": "Time taken to process [[category]] records in [[title]]:[[value]]",
							"bullet": "square",
							"id": "AmGraph-2",
							"title": "GPU",
							"valueField": "GPU"
						}
					],
					"guides": [],
					"valueAxes": [
						{
							"axisFrequency": -2,
							"id": "ValueAxis-1",
							"maximum": 2,
							"minimum": 0,
							"title": "Time taken (s)"
						}
					],
					"allLabels": [],
					"balloon": {},
					"legend": {
						"enabled": true,
						"useGraphSettings": true
					},
					"titles": [
						{
							"id": "Title-1",
							"size": 15,
							"text": "Spark Performance: CPU vs GPU"
						}
					],
					"dataProvider": [
						{
							"category": "100",
							"CPU": "0.3",
							"GPU": "1.3"
						},
						{
							"category": "500",
							"CPU": "0.054",
							"GPU": "0.219"
						},
						{
							"category": "1000",
							"CPU": "0.052",
							"GPU": "0.114"
						},
						{
							"category": "5000",
							"CPU": "0.055",
							"GPU": "0.11"
						},
						{
							"category": "10000",
							"CPU": "0.056",
							"GPU": "0.127"
						},
						{
							"category": "50000",
							"CPU": "0.2",
							"GPU": "0.1"
						},
						{
							"category": "100000",
							"CPU": "0.073",
							"GPU": "0.137"
						},
						{
							"category": "500000",
							"CPU": "0.1",
							"GPU": "0.136"
						},
						{
							"category": "1000000",
							"CPU": "0.2",
							"GPU": "0.159"
						},
						{
							"category": "5000000",
							"CPU": "1",
							"GPU": "0.292"
						},
						{
							"category": "10000000",
							"CPU": "2",
							"GPU": "0.505"
						}
					]
				}
			);
		</script>
	</head>
	<body>
		<div id="chartdiv" style="width: 100%; height: 400px; background-color: #FFFFFF;" ></div>
	</body>
</html><!--kg-card-end: html--><p></p><!--kg-card-begin: html--><!DOCTYPE html>
<html>
	<head>
		<title>chart created with amCharts | amCharts</title>
		<meta name="description" content="chart created using amCharts live editor" />
		
		<!-- amCharts javascript sources -->
		<script type="text/javascript" src="https://www.amcharts.com/lib/3/amcharts.js"></script>
		<script type="text/javascript" src="https://www.amcharts.com/lib/3/serial.js"></script>
		

		<!-- amCharts javascript code -->
		<script type="text/javascript">
			AmCharts.makeChart("chartdiv1",
				{
					"type": "serial",
					"categoryField": "category",
					"startDuration": 1,
					"categoryAxis": {
						"gridPosition": "start",
						"title": "Record Count"
					},
					"trendLines": [],
					"graphs": [
						{
							"balloonText": "Time taken to process [[category]] records in [[title]]:[[value]]",
							"bullet": "round",
							"id": "AmGraph-1",
							"title": "CPU",
							"valueField": "CPU"
						},
						{
							"balloonText": "Time taken to process [[category]] records in [[title]]:[[value]]",
							"bullet": "square",
							"id": "AmGraph-2",
							"title": "GPU",
							"valueField": "GPU"
						}
					],
					"guides": [],
					"valueAxes": [
						{
							"axisFrequency": -2,
							"id": "ValueAxis-1",
							"maximum": 900,
							"minimum": 0,
							"title": "Time taken (s)"
						}
					],
					"allLabels": [],
					"balloon": {},
					"legend": {
						"enabled": true,
						"useGraphSettings": true
					},
					"titles": [
						{
							"id": "Title-1",
							"size": 15,
							"text": "Spark Performance: CPU vs GPU"
						}
					],
					"dataProvider": [
						{
							"category": "100000000",
							"CPU": "34",
							"GPU": "3.004"
						},
						{
							"category": "500000000",
							"CPU": "318",
							"GPU": "167.004"
						},
						{
							"category": "1000000000",
							"CPU": "840",
							"GPU": "324.004"
						}
					]
				}
			);
		</script>
	</head>
	<body>
		<div id="chartdiv1" style="width: 100%; height: 400px; background-color: #FFFFFF;" ></div>
	</body>
</html><!--kg-card-end: html--><p>As you can see from the graphs above, for very less records - with sizes within a few Megabytes - it is faster on the CPU than on the GPU because of the less time taken to propagate the results.</p><p>But things change for the better, when a high volume of records have to start processing. For very high records, you can see a difference of almost 3x. </p><p>Moreover, for 1000000000 records (the last one), my Spark program crashed when run against the CPU. So the 13 minutes that you see above was until when it was successfully running.</p><h3 id="conclusion">Conclusion</h3><p>To confirm whether your program is running against the GPU or not, you can go to the SQL tab, select your job, and then you will see something like <code>GpuRowToColumnar</code>, indicating that the job is running against the GPU.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="http://localhost:2368/content/images/2020/09/Screenshot-from-2020-09-13-23-16-37.png" class="kg-image" alt loading="lazy"><figcaption>Spark running on GPU</figcaption></figure><p>So if you've got heavy workloads, try and offload them to the GPU as much as you can :)</p>
                <section class="m-tags in-post">
                  <h3 class="m-submenu-title">Tags</h3>
                  <ul>
                      <li>
                        <a href="/tag/spark/" title="Spark">Spark</a>
                      </li>
                      <li>
                        <a href="/tag/scala/" title="Scala">Scala</a>
                      </li>
                      <li>
                        <a href="/tag/graphics/" title="Graphics">Graphics</a>
                      </li>
                      <li>
                        <a href="/tag/nvidia/" title="Nvidia">Nvidia</a>
                      </li>
                      <li>
                        <a href="/tag/gpu/" title="GPU">GPU</a>
                      </li>
                  </ul>
                </section>
            </div>
          </div>
        </div>
        <section class="m-author">
          <div class="m-author__content">
            <div class="m-author__picture">
              <a href="http://localhost:2368/author/sparker0i/" class="m-author-picture" aria-label="Aaditya Menon">
                  <div style="background-image: url(http://localhost:2368/content/images/2022/02/72678158_2843214719045409_4986419922138562560_n.jpg);"></div>
              </a>
            </div>
            <div class="m-author__info">
              <h4 class="m-author__name">
                <a href="http://localhost:2368/author/sparker0i/">Aaditya Menon</a>
              </h4>
              <ul class="m-author-links">
                  <li>
                    <a href="https://twitter.com/@Sparker0i" target="_blank" rel="noopener" aria-label="Twitter">
                      <span class="icon-twitter" aria-hidden="true"></span>
                    </a>
                  </li>
              </ul>
            </div>
          </div>
        </section>
            <section class="m-recommended">
              <div class="l-wrapper in-recommended">
                <h3 class="m-section-title in-recommended">Recommended for you</h3>
                <div class="m-recommended-articles">
                  <div class="m-recommended-slider swiper js-recommended-slider">
                    <div class="swiper-wrapper">
                      
    <div class="m-recommended-slider__item swiper-slide">
  <article class="m-article-card  post tag-spark tag-spark-ml tag-scala tag-big-data tag-machine-learning">
    <div class="m-article-card__picture">
      <a href="/spark-machine-learning-knn/" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="/content/images/size/w600/2020/04/mllib-1.jpg" loading="lazy" alt="">
      <a href="http://localhost:2368/author/sparker0i/" class="m-article-card__author js-tooltip" aria-label="Aaditya Menon" data-tippy-content="Posted by Aaditya Menon ">
          <div style="background-image: url(/content/images/size/w100/2022/02/72678158_2843214719045409_4986419922138562560_n.jpg);"></div>
      </a>
    </div>
      <div class="m-article-card__info">
        <a href="http://localhost:2368/tag/spark/" class="m-article-card__tag">Spark</a>
      <a href="/spark-machine-learning-knn/" class="m-article-card__info-link" aria-label="Cool Spark ML: K Nearest Neighbors">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Cool Spark ML: K Nearest Neighbors">
            Cool Spark ML: K Nearest Neighbors
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>2 years ago</span>
          <span>&bull;</span>
          <span>7 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
    <div class="m-recommended-slider__item swiper-slide">
  <article class="m-article-card  post tag-graphics tag-linux tag-os tag-ubuntu">
    <div class="m-article-card__picture">
      <a href="/install-nvidia-drivers-the-right-way-on-linux/" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="/content/images/size/w600/wordpress/2017/10/nvidia-header.png" loading="lazy" alt="">
      <a href="http://localhost:2368/author/sparker0i/" class="m-article-card__author js-tooltip" aria-label="Aaditya Menon" data-tippy-content="Posted by Aaditya Menon ">
          <div style="background-image: url(/content/images/size/w100/2022/02/72678158_2843214719045409_4986419922138562560_n.jpg);"></div>
      </a>
    </div>
      <div class="m-article-card__info">
        <a href="http://localhost:2368/tag/graphics/" class="m-article-card__tag">Graphics</a>
      <a href="/install-nvidia-drivers-the-right-way-on-linux/" class="m-article-card__info-link" aria-label="Install NVidia drivers the right way on Linux">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Install NVidia drivers the right way on Linux">
            Install NVidia drivers the right way on Linux
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>6 years ago</span>
          <span>&bull;</span>
          <span>4 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
    <div class="m-recommended-slider__item swiper-slide">
  <article class="m-article-card  post tag-spark tag-spark-ml tag-nvidia">
    <div class="m-article-card__picture">
      <a href="/spark-3-native-gpu-integration/" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="/content/images/size/w600/2020/05/NVIDIA-Accelerates-Apache-Spark.jpg" loading="lazy" alt="">
      <a href="http://localhost:2368/author/sparker0i/" class="m-article-card__author js-tooltip" aria-label="Aaditya Menon" data-tippy-content="Posted by Aaditya Menon ">
          <div style="background-image: url(/content/images/size/w100/2022/02/72678158_2843214719045409_4986419922138562560_n.jpg);"></div>
      </a>
    </div>
      <div class="m-article-card__info">
        <a href="http://localhost:2368/tag/spark/" class="m-article-card__tag">Spark</a>
      <a href="/spark-3-native-gpu-integration/" class="m-article-card__info-link" aria-label="Spark 3.0 adds native GPU integration: Why that matters?">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Spark 3.0 adds native GPU integration: Why that matters?">
            Spark 3.0 adds native GPU integration: Why that matters?
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>2 years ago</span>
          <span>&bull;</span>
          <span>3 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
                    </div>
                    <button class="m-icon-button filled in-recommended-articles swiper-button-prev" aria-label="Previous">
                      <span class="icon-arrow-left" aria-hidden="true"></span>
                    </button>
                    <button class="m-icon-button filled in-recommended-articles swiper-button-next" aria-label="Next">
                      <span class="icon-arrow-right" aria-hidden="true"></span>
                    </button>
                  </div>
                </div>
              </div>
            </section>
    </div>
  </article>
</main>



    
<div class="m-search js-search" role="dialog" aria-modal="true" aria-label="Search">
  <button class="m-icon-button outlined as-close-search js-close-search" aria-label="Close search">
    <span class="icon-close" aria-hidden="true"></span>
  </button>
  <div class="m-search__content">
    <form class="m-search__form">
      <div class="pos-relative">
        <span class="icon-search m-search-icon" aria-hidden="true"></span>
        <label for="search-input" class="sr-only">
          Type to search
        </label>
        <input id="search-input" type="text" class="m-input in-search js-input-search" placeholder="Type to search">
      </div>
    </form>
    <div class="js-search-results hide"></div>
    <p class="m-not-found align-center hide js-no-results">
      No results for your search, please try with something else.
    </p>
  </div>
</div>

    
<footer class="m-footer">
  <div class="m-footer__content">
    <nav class="m-footer-social">
        <a href="https://www.facebook.com/Sparker0i" target="_blank" rel="noopener" aria-label="Facebook">
          <span class="icon-facebook" aria-hidden="true"></span>
        </a>
        <a href="https://twitter.com/Sparker0i" target="_blank" rel="noopener" aria-label="Twitter">
          <span class="icon-twitter" aria-hidden="true"></span>
        </a>
      <a href="http://localhost:2368/rss" aria-label="RSS">
        <span class="icon-rss" aria-hidden="true"></span>
      </a>
    </nav>
    <p class="m-footer-copyright">
      <span>Sparker0i&#x27;s Blog &copy; 2022</span>
      <span>&nbsp; &bull; &nbsp;</span>
      <span>Published with <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a></span>
    </p>
    <p class="m-footer-copyright jslicense">
      <a href="/assets/html/javascript.html?v=4055984ae1" rel="jslicense">JavaScript license information</a>
    </p>
  </div>
</footer>

    <script defer src="/assets/js/manifest.js?v=4055984ae1"></script>
    <script defer src="/assets/js/vendor/content-api.min.js?v=4055984ae1"></script>
    <script defer src="/assets/js/vendor.js?v=4055984ae1"></script>
    <script defer src="/assets/js/app.js?v=4055984ae1"></script>

      <script defer src="/assets/js/post.js?v=4055984ae1"></script>


    <script>
  var followSocialMedia = {
    youtube: ["https://www.youtube.com/c/sparker0i", "Sparker0i"],
    instagram: ["https://instagram.com/sparker0i", "Sparker0i"],
    github: ["https://github.com/sparker0i", "Sparker0i"],
    linkedin: ["https://www.linkedin.com/in/sparker0i", "Sparker0i"]
  };
</script>

<script>
  var youTube = {
    name: "Sparker0i",
    channelId: "UC720N9wQAevIjCD50x4RliQ",
  };
</script>

<script>
  var disqusShortName = "sparker0is-blog";
</script>

<script>
	var searchSettings = {
        key: "12584d6e462ba2c007d10f133c",
        url: "https://blog.sparker0i.me",
        options: {
          keys: ["title"],
          limit: 10,
        },
        api: {
          resource: "posts",
          parameters: {
            limit: "all",
            fields: ["title", "slug"],
            filter: "",
            include: "",
            order: "",
            formats: "",
          },
        },
    };
</script>
  </body>
</html>
